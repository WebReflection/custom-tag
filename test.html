<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <script defer src="//unpkg.com/tressa@0.1.4/tressa.js"></script>
    <script defer src="//cdnjs.cloudflare.com/ajax/libs/document-register-element/1.1.1/document-register-element.js"></script>
    <script defer src="//unpkg.com/classtrophobic@0.1.2/classtrophobic.min.js"></script>
    <script defer src="index.js"></script>
    <script>
    var MyElement;
    this.onload = function () {
      var test = tressa;

      CustomTag.Class = Class;

      test.title('CustomTag');

      test.async(function (done) {

        test.log('## MyElement');
        CustomTag.whenDefined('my-element').then(function () {
          test(CustomTag.get('my-element') === MyElement, 'class');
          document.body.appendChild(new MyElement);
        });

        MyElement = CustomTag({
          name: 'my-element',
          watch: ['attribute'],
          onInit: function () {
            test(true, 'initialized');
          },
          onConnect: function () {
            test(true, 'connected');
            this.attribute = 'test';
          },
          onChange: function (name, prev, curr) {
            test(name === 'attribute', 'changed');
            test(prev == null, 'previous value');
            test(curr === 'test', 'current value');
            this.parentNode.removeChild(this);
          },
          onDisconnect: function () {
            test(true, 'disconnected');
            done();
          }
        });

      });

    };
    </script>
  </head>
  <body></body>
</html>